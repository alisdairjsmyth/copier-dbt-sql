resources:
  jobs:
    [[ project_name ]]_job:
      name: [[ project_name ]]_job

      tasks:
        - task_key: dbt
          environment_key: default
          dbt_task:
            project_directory: ../
            commands:
              - 'dbt deps'
              - 'dbt build[% if with_dbt_artifacts %] --exclude dbt_artifacts[% endif %]'
            catalog: ${var.catalog}
            schema: ${var.schema}
            warehouse_id: ${var.warehouse_id}

      environments:
        - environment_key: default
          spec:
            environment_version: "[[ databricks_serverless_environment_version ]]"
            dependencies:
              - [[ dbt_databricks_dependency ]]

      # Extend the definition of the job here e.g. add scheduling with trigger attribute
